{
  "apiName": "Sistema de Agendamento - API Reference",
  "version": "2.0",
  "clientId": "kc",
  "baseUrl": "http://localhost:8080",
  "description": "Documentação completa da API para o cliente KC. Todas as requisições devem incluir o header: X-Client-Id: kc",

  "authentication": {
    "type": "Header",
    "header": "X-Client-Id",
    "value": "kc",
    "required": true,
    "description": "Todas as requisições devem incluir este header para identificar o tenant/cliente"
  },

  "endpoints": {

    "services": {
      "baseUrl": "/services",
      "description": "Gerenciamento de serviços oferecidos pelo salão",

      "listar": {
        "method": "GET",
        "url": "http://localhost:8080/services",
        "description": "Lista todos os serviços do cliente KC",
        "headers": {
          "X-Client-Id": "kc"
        },
        "response": [
          {
            "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
            "tenantId": "kc",
            "name": "Alongamento de Cílios Fio a Fio",
            "duration": 120,
            "price": 150.00
          },
          {
            "id": "7fb95f64-5717-4562-b3fc-2c963f66afa7",
            "tenantId": "kc",
            "name": "Design de Sobrancelhas",
            "duration": 30,
            "price": 40.00
          }
        ]
      },

      "buscarPorId": {
        "method": "GET",
        "url": "http://localhost:8080/services/{id}",
        "description": "Busca um serviço específico pelo ID",
        "headers": {
          "X-Client-Id": "kc"
        },
        "pathParams": {
          "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6"
        },
        "response": {
          "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
          "tenantId": "kc",
          "name": "Alongamento de Cílios Fio a Fio",
          "duration": 120,
          "price": 150.00
        }
      },

      "criar": {
        "method": "POST",
        "url": "http://localhost:8080/services",
        "description": "Cria um novo serviço para o cliente KC",
        "headers": {
          "Content-Type": "application/json",
          "X-Client-Id": "kc"
        },
        "body": {
          "name": "Alongamento de Cílios Fio a Fio",
          "duration": 120,
          "price": 150.00
        },
        "response": {
          "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
          "tenantId": "kc",
          "name": "Alongamento de Cílios Fio a Fio",
          "duration": 120,
          "price": 150.00
        }
      },

      "atualizar": {
        "method": "PUT",
        "url": "http://localhost:8080/services/{id}",
        "description": "Atualiza um serviço existente",
        "headers": {
          "Content-Type": "application/json",
          "X-Client-Id": "kc"
        },
        "pathParams": {
          "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6"
        },
        "body": {
          "name": "Alongamento de Cílios Fio a Fio - Premium",
          "duration": 150,
          "price": 180.00
        },
        "response": {
          "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
          "tenantId": "kc",
          "name": "Alongamento de Cílios Fio a Fio - Premium",
          "duration": 150,
          "price": 180.00
        }
      },

      "deletar": {
        "method": "DELETE",
        "url": "http://localhost:8080/services/{id}",
        "description": "Remove um serviço",
        "headers": {
          "X-Client-Id": "kc"
        },
        "pathParams": {
          "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6"
        },
        "response": "204 No Content"
      }
    },

    "appointments": {
      "baseUrl": "/appointments",
      "description": "Gerenciamento de agendamentos",

      "listarTodos": {
        "method": "GET",
        "url": "http://localhost:8080/appointments",
        "description": "Lista todos os agendamentos do cliente KC",
        "headers": {
          "X-Client-Id": "kc"
        },
        "response": [
          {
            "id": "8fa85f64-5717-4562-b3fc-2c963f66afa8",
            "tenantId": "kc",
            "date": "2025-12-20",
            "startTime": "10:00",
            "endTime": "12:00",
            "userName": "Maria Silva",
            "userPhone": "5511999999999",
            "reminderSent": false,
            "service": {
              "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
              "name": "Alongamento de Cílios Fio a Fio",
              "duration": 120,
              "price": 150.00
            }
          }
        ]
      },

      "listarPorData": {
        "method": "GET",
        "url": "http://localhost:8080/appointments/date?date=2025-12-20",
        "description": "Lista agendamentos de uma data específica",
        "headers": {
          "X-Client-Id": "kc"
        },
        "queryParams": {
          "date": "2025-12-20"
        },
        "response": [
          {
            "id": "8fa85f64-5717-4562-b3fc-2c963f66afa8",
            "tenantId": "kc",
            "date": "2025-12-20",
            "startTime": "10:00",
            "endTime": "12:00",
            "userName": "Maria Silva",
            "userPhone": "5511999999999",
            "reminderSent": false,
            "service": {
              "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
              "name": "Alongamento de Cílios Fio a Fio",
              "duration": 120,
              "price": 150.00
            }
          }
        ]
      },

      "buscarPorId": {
        "method": "GET",
        "url": "http://localhost:8080/appointments/id/{id}",
        "description": "Busca um agendamento específico pelo ID",
        "headers": {
          "X-Client-Id": "kc"
        },
        "pathParams": {
          "id": "8fa85f64-5717-4562-b3fc-2c963f66afa8"
        },
        "urlExample": "http://localhost:8080/appointments/id/8fa85f64-5717-4562-b3fc-2c963f66afa8",
        "response": {
          "id": "8fa85f64-5717-4562-b3fc-2c963f66afa8",
          "tenantId": "kc",
          "date": "2025-12-20",
          "startTime": "10:00",
          "endTime": "12:00",
          "userName": "Maria Silva",
          "userPhone": "5511999999999",
          "reminderSent": false,
          "service": {
            "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
            "name": "Alongamento de Cílios Fio a Fio",
            "duration": 120,
            "price": 150.00
          }
        }
      },

      "agendamentosFuturos": {
        "method": "GET",
        "url": "http://localhost:8080/appointments/future?userPhone=5511999999999",
        "description": "Busca agendamentos futuros de um cliente pelo telefone",
        "headers": {
          "X-Client-Id": "kc"
        },
        "queryParams": {
          "userPhone": "5511999999999"
        },
        "response": [
          {
            "id": "8fa85f64-5717-4562-b3fc-2c963f66afa8",
            "tenantId": "kc",
            "date": "2025-12-20",
            "startTime": "10:00",
            "endTime": "12:00",
            "userName": "Maria Silva",
            "userPhone": "5511999999999",
            "reminderSent": false,
            "service": {
              "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
              "name": "Alongamento de Cílios Fio a Fio",
              "duration": 120,
              "price": 150.00
            }
          }
        ]
      },

      "agendamentosPassados": {
        "method": "GET",
        "url": "http://localhost:8080/appointments/past?userPhone=5511999999999",
        "description": "Busca histórico de agendamentos de um cliente pelo telefone",
        "headers": {
          "X-Client-Id": "kc"
        },
        "queryParams": {
          "userPhone": "5511999999999"
        },
        "response": [
          {
            "id": "9fa85f64-5717-4562-b3fc-2c963f66afa9",
            "tenantId": "kc",
            "date": "2025-11-15",
            "startTime": "14:00",
            "endTime": "16:00",
            "userName": "Maria Silva",
            "userPhone": "5511999999999",
            "reminderSent": true,
            "service": {
              "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
              "name": "Alongamento de Cílios Fio a Fio",
              "duration": 120,
              "price": 150.00
            }
          }
        ]
      },

      "horariosDisponiveis": {
        "method": "GET",
        "url": "http://localhost:8080/appointments/available-slots?date=2025-12-20",
        "description": "Retorna lista de horários disponíveis para uma data. Horários de 09:00 às 18:00, intervalos de 30min",
        "headers": {
          "X-Client-Id": "kc"
        },
        "queryParams": {
          "date": "2025-12-20"
        },
        "response": [
          "09:00",
          "09:30",
          "12:00",
          "12:30",
          "13:00",
          "13:30",
          "14:00",
          "14:30",
          "15:00",
          "15:30",
          "16:00",
          "16:30",
          "17:00",
          "17:30"
        ],
        "note": "Horários ocupados não aparecem na lista. Se o dia estiver bloqueado, retorna array vazio []"
      },

      "criar": {
        "method": "POST",
        "url": "http://localhost:8080/appointments",
        "description": "Cria um novo agendamento. Agora suporta múltiplos serviços. O horário de término é calculado automaticamente pela soma das durações",
        "headers": {
          "Content-Type": "application/json",
          "X-Client-Id": "kc"
        },
        "body": {
          "serviceIds": [
            "3fa85f64-5717-4562-b3fc-2c963f66afa6",
            "7fb95f64-5717-4562-b3fc-2c963f66afa7"
          ],
          "date": "2025-12-20",
          "startTime": "10:00",
          "userName": "Maria Silva",
          "userPhone": "5511999999999"
        },
        "bodyNote": "serviceIds aceita 1 ou mais UUIDs de serviços. id, tenantId e endTime são gerados automaticamente pelo back-end. endTime = startTime + soma das durações de todos os serviços",
        "response": {
          "id": "8fa85f64-5717-4562-b3fc-2c963f66afa8",
          "tenantId": "kc",
          "date": "2025-12-20",
          "startTime": "10:00",
          "endTime": "12:30",
          "userName": "Maria Silva",
          "userPhone": "5511999999999",
          "reminderSent": false,
          "services": [
            {
              "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
              "tenantId": "kc",
              "name": "Alongamento de Cílios Fio a Fio",
              "duration": 120,
              "price": 150.00
            },
            {
              "id": "7fb95f64-5717-4562-b3fc-2c963f66afa7",
              "tenantId": "kc",
              "name": "Design de Sobrancelhas",
              "duration": 30,
              "price": 40.00
            }
          ]
        },
        "note": "Sistema valida: 1) Se a data não está bloqueada, 2) Se o horário está dentro do expediente (09:00-18:00), 3) Se não há conflito com outros agendamentos. A duração total é a soma de todos os serviços (neste exemplo: 120 + 30 = 150 minutos = 2h30)"
      },
          "tenantId": "kc",
          "date": "2025-12-20",
          "startTime": "10:00",
          "endTime": "12:00",
          "userName": "Maria Silva",
          "userPhone": "5511999999999",
          "reminderSent": false,
          "service": {
            "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
            "name": "Alongamento de Cílios Fio a Fio",
            "duration": 120,
            "price": 150.00
          }
        },
        "note": "Sistema valida: 1) Se a data não está bloqueada, 2) Se o horário está dentro do expediente (09:00-18:00), 3) Se não há conflito com outros agendamentos"
      },

      "cancelar": {
        "method": "DELETE",
        "url": "http://localhost:8080/appointments/{id}",
        "description": "Cancela um agendamento. O horário é liberado para novos agendamentos",
        "headers": {
          "X-Client-Id": "kc"
        },
        "pathParams": {
          "id": "8fa85f64-5717-4562-b3fc-2c963f66afa8"
        },
        "response": "204 No Content"
      }
    },

    "blockedDays": {
      "baseUrl": "/blocked-days",
      "description": "Gerenciamento de dias bloqueados (feriados, folgas)",

      "listarTodos": {
        "method": "GET",
        "url": "http://localhost:8080/blocked-days",
        "description": "Lista todos os dias bloqueados do cliente KC",
        "headers": {
          "X-Client-Id": "kc"
        },
        "response": [
          {
            "id": "4fa85f64-5717-4562-b3fc-2c963f66afa4",
            "tenantId": "kc",
            "specificDate": "2025-12-25",
            "dayOfWeek": null,
            "reason": "Natal - Salão Fechado",
            "recurring": false
          },
          {
            "id": "5fa85f64-5717-4562-b3fc-2c963f66afa5",
            "tenantId": "kc",
            "specificDate": null,
            "dayOfWeek": "SUNDAY",
            "reason": "Fechado aos Domingos",
            "recurring": true
          }
        ]
      },

      "listarEspecificos": {
        "method": "GET",
        "url": "http://localhost:8080/blocked-days/specific",
        "description": "Lista apenas bloqueios de datas específicas (não recorrentes)",
        "headers": {
          "X-Client-Id": "kc"
        },
        "response": [
          {
            "id": "4fa85f64-5717-4562-b3fc-2c963f66afa4",
            "tenantId": "kc",
            "specificDate": "2025-12-25",
            "dayOfWeek": null,
            "reason": "Natal - Salão Fechado",
            "recurring": false
          }
        ]
      },

      "listarRecorrentes": {
        "method": "GET",
        "url": "http://localhost:8080/blocked-days/recurring",
        "description": "Lista apenas bloqueios recorrentes (dias da semana)",
        "headers": {
          "X-Client-Id": "kc"
        },
        "response": [
          {
            "id": "5fa85f64-5717-4562-b3fc-2c963f66afa5",
            "tenantId": "kc",
            "specificDate": null,
            "dayOfWeek": "SUNDAY",
            "reason": "Fechado aos Domingos",
            "recurring": true
          }
        ]
      },

      "datasDisponiveis": {
        "method": "GET",
        "url": "http://localhost:8080/blocked-days/available?startDate=2025-12-01&endDate=2025-12-31",
        "description": "Retorna lista de datas disponíveis (não bloqueadas) em um período",
        "headers": {
          "X-Client-Id": "kc"
        },
        "queryParams": {
          "startDate": "2025-12-01",
          "endDate": "2025-12-31"
        },
        "response": [
          "2025-12-01",
          "2025-12-02",
          "2025-12-03",
          "2025-12-04",
          "2025-12-05",
          "2025-12-06",
          "2025-12-09",
          "2025-12-10"
        ],
        "note": "Datas bloqueadas (específicas ou por dia da semana recorrente) não aparecem na lista"
      },

      "bloquearDataEspecifica": {
        "method": "POST",
        "url": "http://localhost:8080/blocked-days/specific",
        "description": "Bloqueia uma data específica (ex: feriado, evento especial)",
        "headers": {
          "Content-Type": "application/json",
          "X-Client-Id": "kc"
        },
        "body": {
          "date": "2025-12-25",
          "reason": "Natal - Salão Fechado"
        },
        "response": {
          "id": "4fa85f64-5717-4562-b3fc-2c963f66afa4",
          "tenantId": "kc",
          "specificDate": "2025-12-25",
          "dayOfWeek": null,
          "reason": "Natal - Salão Fechado",
          "recurring": false
        }
      },

      "bloquearDiaRecorrente": {
        "method": "POST",
        "url": "http://localhost:8080/blocked-days/recurring",
        "description": "Bloqueia um dia da semana de forma recorrente (ex: todo domingo)",
        "headers": {
          "Content-Type": "application/json",
          "X-Client-Id": "kc"
        },
        "body": {
          "dayOfWeek": "SUNDAY",
          "reason": "Fechado aos Domingos"
        },
        "response": {
          "id": "5fa85f64-5717-4562-b3fc-2c963f66afa5",
          "tenantId": "kc",
          "specificDate": null,
          "dayOfWeek": "SUNDAY",
          "reason": "Fechado aos Domingos",
          "recurring": true
        },
        "note": "Valores possíveis para dayOfWeek: MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY, SUNDAY"
      },

      "desbloquear": {
        "method": "DELETE",
        "url": "http://localhost:8080/blocked-days/{id}",
        "description": "Remove um bloqueio (data específica ou recorrente)",
        "headers": {
          "X-Client-Id": "kc"
        },
        "pathParams": {
          "id": "4fa85f64-5717-4562-b3fc-2c963f66afa4"
        },
        "response": "204 No Content"
      }
    }
  },

  "dataTypes": {
    "Service": {
      "id": "UUID (gerado automaticamente)",
      "tenantId": "string (preenchido automaticamente como 'kc')",
      "name": "string (obrigatório)",
      "duration": "number em minutos (obrigatório)",
      "price": "number decimal (obrigatório)"
    },
    "Appointment": {
      "id": "UUID (gerado automaticamente)",
      "tenantId": "string (preenchido automaticamente como 'kc')",
      "date": "string formato 'YYYY-MM-DD' (obrigatório)",
      "startTime": "string formato 'HH:mm' (obrigatório)",
      "endTime": "string formato 'HH:mm' (calculado automaticamente)",
      "userName": "string (obrigatório)",
      "userPhone": "string formato '5511999999999' (obrigatório)",
      "reminderSent": "boolean (padrão: false)",
      "service": "objeto Service completo"
    },
    "BlockedDay": {
      "id": "UUID (gerado automaticamente)",
      "tenantId": "string (preenchido automaticamente como 'kc')",
      "specificDate": "string formato 'YYYY-MM-DD' ou null",
      "dayOfWeek": "string (MONDAY|TUESDAY|WEDNESDAY|THURSDAY|FRIDAY|SATURDAY|SUNDAY) ou null",
      "reason": "string (obrigatório)",
      "recurring": "boolean (true = dia da semana, false = data específica)"
    }
  },

  "businessRules": {
    "horarioFuncionamento": {
      "inicio": "09:00",
      "fim": "18:00",
      "intervaloSlots": "30 minutos"
    },
    "agendamento": {
      "validacoes": [
        "Data não pode estar bloqueada",
        "Horário deve estar dentro do expediente (09:00-18:00)",
        "Não pode conflitar com agendamentos existentes",
        "Horário de término não pode ultrapassar 18:00"
      ],
      "conflito": "Dois agendamentos conflitam se há sobreposição de horários"
    },
    "multiTenant": {
      "isolamento": "Dados de clientes diferentes são completamente isolados",
      "mesmoHorario": "Clientes diferentes podem agendar no mesmo horário e data"
    }
  },

  "errorResponses": {
    "400": {
      "description": "Bad Request - Dados inválidos",
      "example": {
        "timestamp": "2025-12-30T10:00:00",
        "status": 400,
        "error": "Bad Request",
        "message": "Horário selecionado conflita com agendamento existente"
      }
    },
    "404": {
      "description": "Not Found - Recurso não encontrado",
      "example": {
        "timestamp": "2025-12-30T10:00:00",
        "status": 404,
        "error": "Not Found",
        "message": "Agendamento não encontrado com ID: xyz"
      }
    },
    "500": {
      "description": "Internal Server Error - Erro no servidor",
      "example": {
        "timestamp": "2025-12-30T10:00:00",
        "status": 500,
        "error": "Internal Server Error",
        "message": "Erro ao processar requisição"
      }
    }
  },

  "notes": [
    "✅ OBRIGATÓRIO: Todas as requisições devem incluir o header 'X-Client-Id: kc' ou 'X-Client-Id: mjs'",
    "❌ NUNCA envie 'id' ou 'tenantId' no body das requisições POST/PUT",
    "❌ O 'id' é gerado automaticamente pelo banco de dados (UUID)",
    "❌ O 'tenantId' é extraído automaticamente do header 'X-Client-Id'",
    "✅ serviceIds deve ser um ARRAY com 1 ou mais UUIDs de serviços",
    "✅ Para 1 serviço: serviceIds: ['uuid1']",
    "✅ Para múltiplos: serviceIds: ['uuid1', 'uuid2', 'uuid3']",
    "✅ Duração total = soma das durações de todos os serviços selecionados",
    "✅ Datas no formato: YYYY-MM-DD (ex: 2025-12-20)",
    "✅ Horários no formato: HH:mm (ex: 10:00, 14:30)",
    "✅ Telefone sem espaços ou caracteres especiais (ex: 5511999999999)",
    "✅ IDs recebidos nas respostas são UUIDs no formato: 3fa85f64-5717-4562-b3fc-2c963f66afa6",
    "✅ Todos os dados são filtrados automaticamente pelo tenant ('kc' ou 'mjs')",
    "✅ Horários disponíveis: 09:00 às 18:00 com intervalos de 30 minutos",
    "✅ Sistema envia WhatsApp automaticamente ao criar agendamento",
    "✅ endTime em agendamentos é calculado automaticamente (startTime + soma das durações)"
  ]
}

